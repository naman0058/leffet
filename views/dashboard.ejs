<%- include ('./adminheader.ejs') %>
      <!-- Main Content -->
      <div class="main-content">
        <section class="section">
          <div class="row ">
            <div class="col-xl-3 col-lg-6">
              <div class="card l-bg-green-dark">
                <div class="card-statistic-3">
                  <div class="card-icon card-icon-large"><i class="fa fa-award"></i></div>
                  <div class="card-content">
                    <h4 class="card-title">Running Orders</h4>
                    <span><%=result[3][0].total%></span>
                    <div class="progress mt-1 mb-1" data-height="8">
                      <div class="progress-bar l-bg-purple" role="progressbar" data-width="<%=result[3][0].total%>%" aria-valuenow="25"
                        aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <p class="mb-0 text-sm">
                     <span class="text-nowrap">Recently Updated</span>
                    </p>
                  </div>
                  
                </div>
              </div>
            </div>
            <div class="col-xl-3 col-lg-6">
              <div class="card l-bg-cyan-dark">
                <div class="card-statistic-3">
                  <div class="card-icon card-icon-large"><i class="fa fa-briefcase"></i></div>
                  <div class="card-content">
                    <h4 class="card-title">Completed Orders</h4>
                    <span><%=result[4][0].total%></span>
                    <div class="progress mt-1 mb-1" data-height="8">
                      <div class="progress-bar l-bg-orange" role="progressbar" data-width="<%=result[4][0].total%>%" aria-valuenow="25"
                        aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <p class="mb-0 text-sm">
                    
                      <span class="text-nowrap">Recently Updated</span>
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-xl-3 col-lg-6">
              <div class="card l-bg-purple-dark">
                <div class="card-statistic-3">
                  <div class="card-icon card-icon-large"><i class="fa fa-globe"></i></div>
                  <div class="card-content">
                    <h4 class="card-title">Total Orders</h4>
                    <span><%=result[5][0].total%></span>
                    <div class="progress mt-1 mb-1" data-height="8">
                      <div class="progress-bar l-bg-cyan" role="progressbar" data-width="<%=result[5][0].total%>%" aria-valuenow="25"
                        aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <p class="mb-0 text-sm">
                    
                      <span class="text-nowrap">Recently Updated</span>
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-xl-3 col-lg-6">
              <div class="card l-bg-orange-dark">
                <div class="card-statistic-3">
                  <div class="card-icon card-icon-large"><i class="fa fa-money-bill-alt"></i></div>
                  <div class="card-content">
                    <h4 class="card-title">Users</h4>
                    <span><%=result[2][0].total%></span>
                    <div class="progress mt-1 mb-1" data-height="8">
                      <div class="progress-bar l-bg-green" role="progressbar" data-width="<%=result[2][0].total%>%" aria-valuenow="25"
                        aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <p class="mb-0 text-sm">
                
                      <span class="text-nowrap">Recently Updated</span>
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>




          <div class="row ">
            <div class="col-xl-3 col-lg-6">
              <div class="card l-bg-green-dark">
                <div class="card-statistic-3">
                  <div class="card-icon card-icon-large"><i class="fa fa-award"></i></div>
                  <div class="card-content">
                    <h4 class="card-title">Today's Earning</h4>
                    <span>Rs. <%=result[7][0].total%></span>
                    <div class="progress mt-1 mb-1" data-height="8">
                      <div class="progress-bar l-bg-purple" role="progressbar" data-width="<%=result[7][0].total%>" aria-valuenow="25"
                        aria-valuemin="0" aria-valuemax="100000000"></div>
                    </div>
                    <p class="mb-0 text-sm">
                      
                      <span class="text-nowrap">Recently Updated</span>
                    </p>
                  </div>
                  
                </div>
              </div>
            </div>
            <div class="col-xl-3 col-lg-6">
              <div class="card l-bg-cyan-dark">
                <div class="card-statistic-3">
                  <div class="card-icon card-icon-large"><i class="fa fa-briefcase"></i></div>
                  <div class="card-content">
                    <h4 class="card-title">Total Earning</h4>
                    <span>Rs. <%=result[6][0].total%></span>
                    <div class="progress mt-1 mb-1" data-height="8">
                      <div class="progress-bar l-bg-orange" role="progressbar" data-width="<%=result[6][0].total%>" aria-valuenow="25"
                        aria-valuemin="0" aria-valuemax="999999999999"></div>
                    </div>
                    <p class="mb-0 text-sm">
                     
                      <span class="text-nowrap">Recently Updated</span>
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-xl-3 col-lg-6">
              <div class="card l-bg-purple-dark">
                <div class="card-statistic-3">
                  <div class="card-icon card-icon-large"><i class="fa fa-globe"></i></div>
                  <div class="card-content">
                    <h4 class="card-title">Category</h4>
                    <span><%=result[0][0].total%></span>
                    <div class="progress mt-1 mb-1" data-height="8">
                      <div class="progress-bar l-bg-cyan" role="progressbar" data-width="<%=result[0][0].total%>%" aria-valuenow="25"
                        aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <p class="mb-0 text-sm">
                    
                      <span class="text-nowrap">Recently Updated</span>
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-xl-3 col-lg-6">
              <div class="card l-bg-orange-dark">
                <div class="card-statistic-3">
                  <div class="card-icon card-icon-large"><i class="fa fa-money-bill-alt"></i></div>
                  <div class="card-content">
                    <h4 class="card-title">Product</h4>
                    <span><%=result[1][0].total%></span>
                    <div class="progress mt-1 mb-1" data-height="8">
                      <div class="progress-bar l-bg-green" role="progressbar" data-width="<%=result[1][0].total%>%" aria-valuenow="25"
                        aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <p class="mb-0 text-sm">
                     
                      <span class="text-nowrap">Recently Updated</span>
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>


          <!-- <div class="row">
            <div class="col-12 col-sm-12 col-lg-12">
              <div class="card">
                <div class="card-header">
                  <h4>Set Delivery Charges</h4>
                </div>
                <div class="card-body">
                  <div class="row">
                    <div class="col-lg-6">
                      <label>Set Delivery Charges </label>
                      <input type="text" name="" id="set_charges" class="form-control" value="<%=result[9][0].set_charges%>">
                    </div>

                    <div class="col-lg-6">
                      <label>Delivery Charges</label>
                      <input type="text" name="" id="delivery_charges" class="form-control" value="<%=result[9][0].charges%>">
                    </div>
                   
                  </div>
                </div>
                <div class="card-footer">
                  <button class="btn btn-primary" id="charges_set">Submit</button>
                </div>
              </div>
            </div>
          </div>
         -->
         
          <div class="row">
            <div class="col-12 col-sm-12 col-lg-12">
              <div class="card">
                <div class="card-header">
                  <h4>Running Orders</h4>
                </div>
                <div class="card-body">

                  <!-- <select class="form-control" name="delivery_boy" id="delivery_boy"> -->



                  </select>

                  <div class="table-responsive table-invoice">
                    <table class="table table-striped">
                      <tr>
                   
                        <th>Customer Name</th>
                        <th>Customer Email</th>
                        <th>Product Name</th>
                        <th>Address</th>
                        <th>Payment Mode</th>
                        <th>Progress</th>
                        <th>Price</th>
                        <th>Status</th>
                        
                      </tr>


<% for(i=0;i<result[8].length;i++) { %>

                      <tr>
                       
                        <td><%=result[8][i].name%></td>
                        <td><%=result[8][i].usermobilenumber%></td>
                        <td class="font-weight-600"><%=result[8][i].productname%></td>
                        <td class="font-weight-600">
                          <%=result[i].useraddress1 , result[i].useraddress2  , result[i].userstate , result[i].usercity , result[i].userpostcode , result[i].usercountry %>

                        </td>
                        <td class="font-weight-600"><%=result[8][i].payment_mode%></td>

                        <td class="font-weight-600"><%=result[8][i].status%></td>
                        

                       
                        <td>Rs. <%=result[8][i].price%></td>


                     




                   
<% if(result[8][i].status=='pending') { %>

 <td> <a href="/admin/update-status?id=<%=result[8][i].id%>&status=In Transit">In Transit</a></td>

  <% } else if(result[8][i].status=='In Transit') { %>
   
    <td> <a href="/admin/update-status?id=<%=result[8][i].id%>&status=Shipping">Shipping</a></td>

    <% } else { %> 

      <td> <a href="/admin/update-status?id=<%=result[8][i].id%>&status=Completed">Delivered</a></td>

      <% } %>

                        <td>
                          <!-- <select class="form-control update_status"  id='<%=result[8][i].id%>'>
                            <option value="-">Select Status</option>
                            <option value="Dispatch">Dispatch</option>
                            <option val>Completed</option>
                          </select> -->
                        </td>
                      
                           </tr>

                           <% } %>
                    
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        
        </section>
        <div class="settingSidebar">
          <a href="javascript:void(0)" class="settingPanelToggle"> <i class="fa fa-spin fa-cog"></i>
          </a>
          <div class="settingSidebar-body ps-container ps-theme-default">
            <div class=" fade show active">
              <div class="setting-panel-header">Setting Panel
              </div>
              <div class="p-15 border-bottom">
                <h6 class="font-medium m-b-10">Select Layout</h6>
                <div class="selectgroup layout-color w-50">
                  <label class="selectgroup-item">
                    <input type="radio" name="value" value="1" class="selectgroup-input select-layout" checked>
                    <span class="selectgroup-button">Light</span>
                  </label>
                  <label class="selectgroup-item">
                    <input type="radio" name="value" value="2" class="selectgroup-input select-layout">
                    <span class="selectgroup-button">Dark</span>
                  </label>
                </div>
              </div>
              <div class="p-15 border-bottom">
                <h6 class="font-medium m-b-10">Sidebar Color</h6>
                <div class="selectgroup selectgroup-pills sidebar-color">
                  <label class="selectgroup-item">
                    <input type="radio" name="icon-input" value="1" class="selectgroup-input select-sidebar">
                    <span class="selectgroup-button selectgroup-button-icon" data-toggle="tooltip"
                      data-original-title="Light Sidebar"><i class="fas fa-sun"></i></span>
                  </label>
                  <label class="selectgroup-item">
                    <input type="radio" name="icon-input" value="2" class="selectgroup-input select-sidebar" checked>
                    <span class="selectgroup-button selectgroup-button-icon" data-toggle="tooltip"
                      data-original-title="Dark Sidebar"><i class="fas fa-moon"></i></span>
                  </label>
                </div>
              </div>
              <div class="p-15 border-bottom">
                <h6 class="font-medium m-b-10">Color Theme</h6>
                <div class="theme-setting-options">
                  <ul class="choose-theme list-unstyled mb-0">
                    <li title="white" class="active">
                      <div class="white"></div>
                    </li>
                    <li title="cyan">
                      <div class="cyan"></div>
                    </li>
                    <li title="black">
                      <div class="black"></div>
                    </li>
                    <li title="purple">
                      <div class="purple"></div>
                    </li>
                    <li title="orange">
                      <div class="orange"></div>
                    </li>
                    <li title="green">
                      <div class="green"></div>
                    </li>
                    <li title="red">
                      <div class="red"></div>
                    </li>
                  </ul>
                </div>
              </div>
              <div class="p-15 border-bottom">
                <div class="theme-setting-options">
                  <label>
                    <span class="control-label p-r-20">Mini Sidebar</span>
                    <input type="checkbox" name="custom-switch-checkbox" class="custom-switch-input"
                      id="mini_sidebar_setting">
                    <span class="custom-switch-indicator"></span>
                  </label>
                </div>
              </div>
              <div class="p-15 border-bottom">
                <div class="theme-setting-options">
                  <div class="disk-server-setting m-b-20">
                    <p>Disk Space</p>
                    <div class="sidebar-progress">
                      <div class="progress" data-height="5">
                        <div class="progress-bar l-bg-green" role="progressbar" data-width="80%" aria-valuenow="80"
                          aria-valuemin="0" aria-valuemax="100"></div>
                      </div>
                      <span class="progress-description">
                        <small>26% remaining</small>
                      </span>
                    </div>
                  </div>
                  <div class="disk-server-setting">
                    <p>Server Load</p>
                    <div class="sidebar-progress">
                      <div class="progress" data-height="5">
                        <div class="progress-bar l-bg-orange" role="progressbar" data-width="58%" aria-valuenow="25"
                          aria-valuemin="0" aria-valuemax="100"></div>
                      </div>
                      <span class="progress-description">
                        <small>Highly Loaded</small>
                      </span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="mt-4 mb-4 p-3 align-center rt-sidebar-last-ele">
                <a href="#" class="btn btn-icon icon-left btn-primary btn-restore-theme">
                  <i class="fas fa-undo"></i> Restore Default
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
      
    </div>
  </div>
  <!-- General JS Scripts -->
  <script src="/light/assets/js/app.min.js"></script>
  <!-- JS Libraies -->
  <script src="/light/assets/bundles/echart/echarts.js"></script>
  <script src="/light/assets/bundles/chartjs/chart.min.js"></script>
  <!-- Page Specific JS File -->
  <script src="/light/assets/js/page/index.js"></script>
  <!-- Template JS File -->
  <script src="/light/assets/js/scripts.js"></script>
  <!-- Custom JS File -->
  <script src="/light/assets/js/custom.js"></script>
</body>


<script>
  $('.update_status').change(function(){
    const id  = $(this).attr('id');
    alert(id)

  })


  $('.assign').click(function(){
    let assigned_number = $('#delivery_boy').val();
    let id = $(this).attr('id')

    // alert(assigned_number)

if(assigned_number==null || assigned_number == 'null'){
  alert('Select Delivery Boy')
}
else{
  $.post('/admin/update/booking/status',{id,assigned_number},data=>{
      window.location.href = '/admin/dashboard'
    })

}

  

  })










  $.getJSON(`/delivery/all`, data => {
    categories1 = data
    fillDropDown('delivery_boy', data, 'Choose Delivery Boy', 0)
  
})
  

function fillDropDown(id, data, label, selectedid = 0) {
    $(`#${id}`).empty()
    $(`#${id}`).append($('<option>').val("null").text(label))

    $.each(data, (i, item) => {
        if (item.id == selectedid) {
            $(`#${id}`).append($('<option selected>').val(item.number).text(item.name))
        } else {
            $(`#${id}`).append($('<option>').val(item.number).text(item.name))
        }
    })
}


$('#charges_set').click(function(){
  let charges = $('#delivery_charges').val()
  let set_charges = $('#set_charges').val()

  $.post('/admin/charges/update',{charges,set_charges},data=>{
         window.location.reload()
  })
})



</script>






</html>